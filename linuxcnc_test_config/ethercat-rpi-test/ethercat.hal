# SUPER SIMPLE HAL Configuration for Single EtherCAT Axis
# For real EtherCAT hardware

# Load the EtherCAT driver (LinuxCNC-EtherCAT)
loadrt lcec
addf lcec.0.read servo-thread
addf lcec.0.write servo-thread

# Load trivkins kinematics and motion controller
loadrt trivkins coordinates=X
loadrt motmod servo_period_nsec=1000000 num_joints=1
addf motion-command-handler servo-thread
addf motion-controller servo-thread

# Connect EtherCAT drive to motion
# Assuming basic EtherCAT servo drive at position 0
net x-pos-cmd joint.0.motor-pos-cmd => lcec.0.0.pos-cmd
net x-pos-fb lcec.0.0.pos-fb => joint.0.motor-pos-fb

# Simple enable chain
net x-enable joint.0.amp-enable-out => lcec.0.0.enable

# E-stop loopback - connect e-stop loop
# For real hardware, you might connect this to a physical E-stop
net estop-loop iocontrol.0.user-enable-out iocontrol.0.emc-enable-in

# Home switch - connect to your actual home switch input if available
# For now, using the same instant home as simulator
net home-x joint.0.home-sw-in <= joint.0.homing